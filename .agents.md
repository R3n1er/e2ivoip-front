# AGENTS.md

Guide dédié aux assistants IA pour le développement du projet E2I VoIP avec Next.js 15, DaisyUI et Vercel. Ce projet est une refonte du site web existant https://www.e2i-vop.com

## 🚀 Stack & Priorities

- **Framework**: NextJS 15 (App Router)
- **CSS**: DaisyUI (priority) → Tailwind → shadcn/ui
- **Animations**: CSS avec Framer Motion
- **Icons**: Lineicons (priority) → React Icons
- **Deployment**: Vercel
- **Testing**: TDD with Jest + Playwright + Browser MCP

## 📋 Code Generation Rules

- Always use DaisyUI components first
- Search Lineicons before React Icons
- Use Framer Motion for Animation
- Write tests before implementation (TDD)
- Document in /docs automatically
- Deploy via Vercel integration

## 🛠️ Setup Commands

- Install deps: `npm install`
- Start dev server: `npm run dev`
- Run tests: `npm test`
- Run E2E tests: `npm run test:e2e`
- Build: `npm run build`
- Deploy: `npm run vercel:deploy`

## 🎨 Code Style

- TypeScript strict mode
- Single quotes, no semicolons
- Use functional patterns where possible
- DaisyUI classes priority over custom CSS
- Lineicons for all iconography needs
- React Icons only as fallback

## 🧪 Testing Instructions

### Test-Driven Development (TDD) Obligatoire

1. **RED**: Write failing test first
2. **GREEN**: Implement minimal code to pass test
3. **REFACTOR**: Optimize while keeping tests green
4. **DOCUMENT**: Update documentation automatically
5. **COMMIT & PUSH**: After complete test validation

### Test Commands

```bash
# Unit tests
npm test

# Coverage tests
npm run test:ci

# E2E tests
npm run test:e2e

# All tests before deployment
npm run test:all
```

### Test Requirements

- **100% test coverage** for new components
- **DaisyUI selectors** in tests (not custom classes)
- **Accessibility testing** for all interactive elements
- **Icon testing** with proper aria-labels
- **Responsive testing** on multiple breakpoints

## 🔧 Development Environment Tips

### Project Structure

```
e2ivoip-front/
├── app/                    # Next.js App Router pages
├── components/             # React components
│   ├── ui/                # DaisyUI custom components
│   └── ...
├── lib/                   # Utilities and configurations
├── tests/                 # Test files
├── docs/                  # Project documentation
└── public/                # Static assets
```

### Component Creation Workflow

1. **Create test file** first (`__tests__/components/ComponentName.test.tsx`)
2. **Implement component** using DaisyUI + Lineicons
3. **Add to documentation** (`docs/components/ComponentName.md`)
4. **Update roadmap** if new feature (with permission)

### Icon Usage Priority

```typescript
// ✅ PRIORITY: Lineicons
import { LineIcon } from "react-lineicons";
<LineIcon name="lni-home" aria-label="Home" />;

// ⚠️ FALLBACK: React Icons (only if Lineicons doesn't have it)
import { FiSettings } from "react-icons/fi";
<FiSettings aria-label="Settings" />;
```

## 📚 Documentation Rules

### Automatic Documentation

- **Technical docs**: Can be updated automatically
- **Component docs**: Create automatically in `/docs/components/`
- **API docs**: Update automatically in `/docs/api/`

### Permission Required

- **PRD.md**: Requires explicit permission to modify
- **roadmap.md**: Requires explicit permission to modify
- **Strategic decisions**: Always ask before changing

### Documentation Structure

```markdown
# Component Name

## Purpose

Brief description of what the component does

## Props

TypeScript interface with descriptions

## Usage Examples

DaisyUI + Lineicons examples

## Accessibility

ARIA labels and roles

## Tests

Link to test file
```

## 🚀 Deployment & Vercel

### Vercel Integration

- **Automatic deployment** on git push to main
- **Preview deployments** for pull requests
- **Environment variables** configured in Vercel dashboard
- **Edge Functions** for optimal performance

### Pre-deployment Checklist

- [ ] All tests pass (`npm run test:all`)
- [ ] Build successful (`npm run build`)
- [ ] Linting clean (`npm run lint`)
- [ ] Type checking passes (`npm run type-check`)
- [ ] Documentation updated

### Vercel Commands

```bash
# Link project to Vercel
npx vercel link

# Deploy manually
npm run vercel:deploy

# Environment variables
vercel env add VARIABLE_NAME
```

## 🔒 Security & Best Practices

### Component Security

- **Input validation** for all user inputs
- **XSS prevention** with proper escaping
- **CSRF protection** for forms
- **Content Security Policy** headers

### Performance Optimization

- **Server Components** by default
- **Client Components** only when necessary
- **Image optimization** with `next/image`
- **Code splitting** with dynamic imports
- **Lazy loading** for non-critical components

## 🎨 E2I VoIP Visual Standards

### Hero Section Gradient Standard

**MANDATORY** for all hero sections across the site:

```tsx
{/* Hero Section Standard E2I VoIP */}
<section className="relative py-20 overflow-hidden">
  <div className="absolute inset-0">
    <img
      src="/background-image.jpg"
      alt="Alt description"
      className="absolute inset-0 w-full h-full object-cover"
    />
    {/* Standard E2I VoIP Gradient Overlay */}
    <div className="absolute inset-0 bg-gradient-to-r from-blue-900/85 via-blue-800/80 to-red-600/85 pointer-events-none z-10"></div>
  </div>
  <div className="relative z-20 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    {/* Hero content */}
  </div>
</section>
```

**Gradient specs**:
- Class: `bg-gradient-to-r from-blue-900/85 via-blue-800/80 to-red-600/85`
- Direction: Left to right (dark blue → marine blue → red)
- Opacity: Semi-transparent to show background image
- Z-index: 10 for overlay, 20 for content

## 🎯 Common Patterns

### DaisyUI + Lineicons Button

```typescript
import { LineIcon } from "react-lineicons";

interface ButtonProps {
  variant?: "primary" | "secondary" | "outline";
  size?: "sm" | "md" | "lg";
  icon?: string; // Lineicon name
  children: React.ReactNode;
  onClick?: () => void;
}

export const Button = ({
  variant = "primary",
  size = "md",
  icon,
  children,
  onClick,
}: ButtonProps) => {
  return (
    <button className={`btn btn-${variant} btn-${size}`} onClick={onClick}>
      {icon && <LineIcon name={icon} className="mr-2" />}
      {children}
    </button>
  );
};
```

### Form with DaisyUI

```typescript
import { LineIcon } from "react-lineicons";

export const ContactForm = () => {
  return (
    <form className="card bg-base-100 shadow-xl">
      <div className="card-body">
        <h2 className="card-title">
          <LineIcon name="lni-envelope" className="mr-2" />
          Contact Us
        </h2>

        <div className="form-control">
          <label className="label">
            <span className="label-text">Email</span>
          </label>
          <input
            type="email"
            className="input input-bordered"
            placeholder="your@email.com"
          />
        </div>

        <div className="form-control">
          <label className="label">
            <span className="label-text">Message</span>
          </label>
          <textarea
            className="textarea textarea-bordered"
            placeholder="Your message..."
          />
        </div>

        <div className="card-actions justify-end">
          <button className="btn btn-primary">
            <LineIcon name="lni-send" className="mr-2" />
            Send Message
          </button>
        </div>
      </div>
    </form>
  );
};
```

## 🧪 Testing Examples

### Component Test

```typescript
import { render, screen } from "@testing-library/react";
import userEvent from "@testing-library/user-event";
import { Button } from "@/components/ui/Button";

describe("Button Component", () => {
  it("renders with DaisyUI classes", () => {
    render(<Button variant="primary">Click me</Button>);

    const button = screen.getByRole("button");
    expect(button).toHaveClass("btn", "btn-primary");
  });

  it("displays icon when provided", () => {
    render(<Button icon="lni-home">Home</Button>);

    const icon = screen.getByRole("img", { hidden: true });
    expect(icon).toBeInTheDocument();
  });

  it("calls onClick when clicked", async () => {
    const handleClick = jest.fn();
    render(<Button onClick={handleClick}>Click me</Button>);

    await userEvent.click(screen.getByRole("button"));
    expect(handleClick).toHaveBeenCalledTimes(1);
  });
});
```

### E2E Test with Playwright

```typescript
import { test, expect } from "@playwright/test";

test("user can submit contact form", async ({ page }) => {
  await page.goto("/contact");

  // Fill form using DaisyUI selectors
  await page.fill('.input[placeholder="your@email.com"]', "test@example.com");
  await page.fill('.textarea[placeholder="Your message..."]', "Hello World");

  // Submit form
  await page.click(".btn-primary");

  // Verify success
  await expect(page.locator(".alert-success")).toBeVisible();
});
```

## 🔄 Git Workflow

### Branch Naming

- `feature/component-name` for new components
- `fix/issue-description` for bug fixes
- `docs/update-description` for documentation
- `test/add-component-tests` for test additions

### Commit Messages

- `feat: add new Button component with DaisyUI styling`
- `fix: resolve accessibility issue in form validation`
- `test: add comprehensive tests for Button component`
- `docs: update component documentation with examples`

### Pull Request Guidelines

- **Title format**: `[Component] Brief description`
- **Description**: Include test results and documentation updates
- **Tests**: All tests must pass before merge
- **Documentation**: Technical docs updated automatically

## 🚨 Troubleshooting

### Common Issues

1. **DaisyUI not working**: Check `tailwind.config.js` and ensure DaisyUI plugin is loaded
2. **Lineicons not displaying**: Verify CDN link in layout or npm package installation
3. **Tests failing**: Run `npm run test:ci` to see detailed error messages
4. **Build errors**: Check TypeScript errors with `npm run type-check`

### Performance Issues

- **Large bundle**: Use dynamic imports for heavy components
- **Slow rendering**: Convert to Server Components where possible
- **Image loading**: Implement proper `next/image` optimization

## 📖 Resources

- **Next.js 15**: https://nextjs.org/docs
- **DaisyUI**: https://daisyui.com/
- **Lineicons**: https://lineicons.com/
- **Vercel**: https://vercel.com/docs
- **Playwright**: https://playwright.dev/
- **Testing Library**: https://testing-library.com/

## 🤖 AI Assistant Instructions

### What You Can Do Automatically

- ✅ Create new components with DaisyUI + Lineicons
- ✅ Write comprehensive tests (unit + E2E)
- ✅ Update technical documentation
- ✅ Modify configuration files
- ✅ Add new dependencies
- ✅ Create utility functions

### What Requires Permission

- ❌ Modify PRD.md or roadmap.md
- ❌ Change project strategy or requirements
- ❌ Remove existing functionality
- ❌ Modify production environment variables

### Always Ask Before

- "Should I write tests first for this component?"
- "Which Lineicon would be most appropriate here?"
- "Do you want me to update the roadmap with this new feature?"
- "Should this be a Server Component or Client Component?"

---

_This AGENTS.md file provides comprehensive guidance for AI coding assistants working on the E2I VoIP project. Follow the TDD approach, prioritize DaisyUI + Lineicons, and always ask for permission when modifying strategic documents._
